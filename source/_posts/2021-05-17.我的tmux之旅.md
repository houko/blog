---
author: 小莫
date: 2021-05-17
title: 我的tmux之旅
tags:
- 工具
category: technology
permalink: ohmytmux

---

之前在中期学习计划中将tmux列入其中，但是一直没有花时间研究。周末看番的时候有一个[tmux的视频推荐](https://www.bilibili.com/video/BV1Qq4y1f7N1?t=693)，点开看了一下觉得讲的挺好的，感觉是时候在工作中导入这个工具了。视频也直接嵌在正文中，有需要的朋友不妨看一下。
<!-- more -->

<iframe src="//player.bilibili.com/player.html?aid=588001797&bvid=BV1Qq4y1f7N1&cid=339146205&page=1" scrolling="no" border="0" height="768" width="1024" frameborder="no" framespacing="0" allowfullscreen="true"> </iframe>

#### 开胃菜

视频开头的动画up主讲到这个软件名字叫`asciiquarium`, 可以通过`brew install asciiquarium`命令来安装。其实没什么太大作用，就是终端中的一个动画，当作终端的屏保也不错。

`q` 退出动画

`p` 暂停动画 

`r` 重置动画



#### tmux介绍

Tmux是一个键盘驱动的终端分屏工具，可以替代Linux下的screen。当然，如果是在Mac下使用的话，它的核心功能(例如window，分屏等)也是可以被iTerm2替代的，不过好在Tmux在*nix操作系统中足够通用，用包管理工具(apt-get, brew等)即可安装，所以了解并熟练使用它，还是能为平时终端下的工作节省不少时间的。而且最重要的功能是它可以保存会话，避免每次开机都得重复性的去开各种窗口。



#### session

会话，Tmux是一个C/S架构的工具，一个会话可以认为是C端和S端一次交互的上下文。我们的所有操作都属于某个session，session可以长时间存在，也可以临时退出再重进。我们可用通过session来区分不同的工作空间，比如本地操作开一个session，远程SSH操作开一个session，又或者SSH生产环境机器开一个session，SSH测试环境机器开一个session。



#### window

如果说session是个不可见的东西，那么window就是我们输入、执行命令的地方。一个session可以包含多个window。把window类比成iTerm2中的标签应该就理解了。在创建session的时候默认会创建一个以"数字下标+bash"命名的window，并且名称随着bash中执行的不同命令而变化。在新建session时可以通过-n参数指定默认打开的window名称，比如通过 **tmux new -s basic -n win** 命名一个win名称的window。也可以随时通过 **Prefix+,** 来修改window名称。



#### Pane

一个window可以切割成多个pane，也就是所谓的分屏，算是Tmux的核心功能之一。



#### 安装tmux

```bash
# Ubuntu 或 Debian
$ sudo apt-get install tmux

# CentOS 或 Fedora
$ sudo yum install tmux

# Mac
$ brew install tmux
```



#### 配置tmux

```bash
 cd
 git clone https://github.com/gpakosz/.tmux.git
 ln -s -f .tmux/.tmux.conf
 cp .tmux/.tmux.conf.local .
```

做完以上配置后就有了和up演示中一样的功能。



#### 前缀键

Tmux 窗口有大量的快捷键。所有快捷键都要通过前缀键唤起。默认的前缀键是`Ctrl+b`，即先按下`Ctrl+b`，快捷键才会生效。

举例来说，帮助命令的快捷键是`Ctrl+b ?`。它的用法是，在 Tmux 窗口中，先按下`Ctrl+b`，再按下`?`，就会显示帮助信息。

然后，按下 ESC 键或`q`键，就可以退出帮助。



#### tmux帮助合令

```bash
# 列出所有快捷键，及其对应的 Tmux 命令
$ tmux list-keys

# 列出所有 Tmux 命令及其参数
$ tmux list-commands

# 列出当前所有 Tmux 会话的信息
$ tmux info

# 重新加载当前的 Tmux 配置
$ tmux source-file ~/.tmux.conf
```



#### tmux基本命令

| Ctrl+b      | 激活控制台；此时以下按键生效                                 |                          |
| ----------- | ------------------------------------------------------------ | :----------------------- |
| 系统操作    | ?                                                            | 列出所有快捷键；按q返回  |
| d           | 脱离当前会话；这样可以暂时返回Shell界面，输入tmux attach能够重新进入之前的会话 |                          |
| D           | 选择要脱离的会话；在同时开启了多个会话时使用                 |                          |
| Ctrl+z      | 挂起当前会话                                                 |                          |
| r           | 强制重绘未脱离的会话                                         |                          |
| s           | 选择并切换会话；在同时开启了多个会话时使用                   |                          |
| :           | 进入命令行模式；此时可以输入支持的命令，例如kill-server可以关闭服务器 |                          |
| [           | 进入复制模式；此时的操作与vi/emacs相同，按q/Esc退出          |                          |
| ~           | 列出提示信息缓存；其中包含了之前tmux返回的各种提示信息       |                          |
| 窗口操作    | c                                                            | 创建新窗口               |
| &           | 关闭当前窗口                                                 |                          |
| 数字键      | 切换至指定窗口                                               |                          |
| p           | 切换至上一窗口                                               |                          |
| n           | 切换至下一窗口                                               |                          |
| l           | 在前后两个窗口间互相切换                                     |                          |
| w           | 通过窗口列表切换窗口                                         |                          |
| ,           | 重命名当前窗口；这样便于识别                                 |                          |
| .           | 修改当前窗口编号；相当于窗口重新排序                         |                          |
| f           | 在所有窗口中查找指定文本                                     |                          |
| 面板操作    | ”                                                            | 将当前面板平分为上下两块 |
| %           | 将当前面板平分为左右两块                                     |                          |
| x           | 关闭当前面板                                                 |                          |
| !           | 将当前面板置于新窗口；即新建一个窗口，其中仅包含当前面板     |                          |
| Ctrl+方向键 | 以1个单元格为单位移动边缘以调整当前面板大小                  |                          |
| Alt+方向键  | 以5个单元格为单位移动边缘以调整当前面板大小                  |                          |
| Space       | 在预置的面板布局中循环切换；依次包括even-horizontal、even-vertical、main-horizontal、main-vertical、tiled |                          |
| q           | 显示面板编号                                                 |                          |
| o           | 在当前窗口中选择下一面板                                     |                          |
| 方向键      | 移动光标以选择面板                                           |                          |
| {           | 向前置换当前面板                                             |                          |
| }           | 向后置换当前面板                                             |                          |
| Alt+o       | 逆时针旋转当前窗口的面板                                     |                          |
| Ctrl+o      | 顺时针旋转当前窗口的面板                                     |                          |



#### 窗口 (标签页)[#](https://www.cnblogs.com/lizhang4/p/7325086.html#窗口-(标签页))

```
c  创建新窗口
w  列出所有窗口
n  后一个窗口
p  前一个窗口
f  查找窗口
,  重命名当前窗口
&  关闭当前窗口
```

#### 调整窗口排序[#](https://www.cnblogs.com/lizhang4/p/7325086.html#调整窗口排序)

```
swap-window -s 3 -t 1  交换 3 号和 1 号窗口
swap-window -t 1       交换当前和 1 号窗口
move-window -t 1       移动当前窗口到 1 号
```

#### 窗格（分割窗口）[#](https://www.cnblogs.com/lizhang4/p/7325086.html#窗格（分割窗口）)

```
%  垂直分割
"  水平分割
o  交换窗格
x  关闭窗格
⍽  左边这个符号代表空格键 - 切换布局
q 显示每个窗格是第几个，当数字出现的时候按数字几就选中第几个窗格
{ 与上一个窗格交换位置
} 与下一个窗格交换位置
z 切换窗格最大化/最小化
```

#### 同步窗格[#](https://www.cnblogs.com/lizhang4/p/7325086.html#同步窗格)

这么做可以切换到想要的窗口，输入 Tmux 前缀和一个冒号呼出命令提示行，然后输入：

```
:setw synchronize-panes
```

你可以指定开或关，否则重复执行命令会在两者间切换。 这个选项值针对某个窗口有效，不会影响别的会话和窗口。 完事儿之后再次执行命令来关闭。[帮助](http://blog.sanctum.geek.nz/sync-tmux-panes/)

#### 调整窗格尺寸[#](https://www.cnblogs.com/lizhang4/p/7325086.html#调整窗格尺寸)

如果你不喜欢默认布局，可以重调窗格的尺寸。虽然这很容易实现，但一般不需要这么干。这几个命令用来调整窗格：

```
PREFIX : resize-pane -D          当前窗格向下扩大 1 格
PREFIX : resize-pane -U          当前窗格向上扩大 1 格
PREFIX : resize-pane -L          当前窗格向左扩大 1 格
PREFIX : resize-pane -R          当前窗格向右扩大 1 格
PREFIX : resize-pane -D 20       当前窗格向下扩大 20 格
PREFIX : resize-pane -t 2 -L 20  编号为 2 的窗格向左扩大 20 格
```

#### 杂项：[#](https://www.cnblogs.com/lizhang4/p/7325086.html#杂项：)

```
d  退出 tmux（tmux 仍在后台运行）
t  窗口中央显示一个数字时钟
?  列出所有快捷键
:  命令提示符
```

#### 参考文章

[阮一峰-Tmux 使用教程](http://www.ruanyifeng.com/blog/2019/10/tmux.html)

[亡灵族-tmux常用命令](https://www.cnblogs.com/lizhang4/p/7325086.html)

